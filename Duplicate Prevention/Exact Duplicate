hash_key = SHA256(user_id + "|" + event_type + "|" + normalize(message) + "|" + (dedupe_key || ""))

IF redis.EXISTS("dedup:exact:" + hash_key):
    RETURN verdict=NEVER, reason_code=EXACT_DUPLICATE
ELSE:
    redis.SET("dedup:exact:" + hash_key, "1", EX=600)   # 10-min TTL
    CONTINUE
